<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubean 集群生命周期管理 | YanRongShi</title>
    <meta name="description" content="yanrongshi's blog">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.DkVKqfD-.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CkRnXUbA.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.BsBsMUE8.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Dz7_3PEu.js">
    <link rel="modulepreload" href="/assets/blog_kubean.md.CcJJGHIG.lean.js">
    <link rel="icon" href="/img/ppr.png">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>YanRongShi</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>blog</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/markdown-examples.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Examples</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/book.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>brok</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yanrongshi" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yanrongshi" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible has-active" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>2021</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-edd2eed8><span class="vpi-chevron-right caret-icon" data-v-edd2eed8></span></div></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/blog/ocp_image_registry.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>OCP 镜像仓库调研</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/blog/kubean.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>kubean 使用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _blog_kubean" data-v-e6f2a212><div><h1 id="kubean-集群生命周期管理" tabindex="-1">Kubean 集群生命周期管理 <a class="header-anchor" href="#kubean-集群生命周期管理" aria-label="Permalink to &quot;Kubean 集群生命周期管理&quot;">​</a></h1><h2 id="_01背景" tabindex="-1">01背景 <a class="header-anchor" href="#_01背景" aria-label="Permalink to &quot;01背景&quot;">​</a></h2><p>随着云原生理念的不断发展，越来越多的企业开始将业务部署至 Kubernetes 云平台，大量业务上云为企业带来敏捷与高效的同时，也为企业的运维管理带来了大量新的挑战。如何在兼容不同操作系统部署集群、如何实现跨区域的部署集群、如何实现在等保、信创等场景下在线（离线）部署集群等问题都为企业的应用上云带来了极大的挑战。面对企业业务需求的新变化，传统的基于二进制包部署 Kubernetes 集群存在诸多缺陷和不足。一方面手动部署 Kubernetes 集群涉及的技术栈门类多、门槛高，部署流程繁琐且重复，易于出错。另一方面通过手动部署集群在集群高可用、离线部署、插件预装等方面都存在诸多不足。为了降低 Kubernetes 的使用门槛，方便运维人员快速部署集群，Kubernetes 社区孵化出了一批如 Kubeadm、Kubespray、Kops 等用于快速部署集群的项目。</p><h3 id="社区主流集群生命周期管理工具" tabindex="-1">社区主流集群生命周期管理工具 <a class="header-anchor" href="#社区主流集群生命周期管理工具" aria-label="Permalink to &quot;社区主流集群生命周期管理工具&quot;">​</a></h3><p><strong>Kubeadm</strong>：Kubernetes 官方推荐的集群部署工具，通过使用 init 建立控制节点和 join 来纳管工作节点的模式来构建集群，但是存在诸多小问题，无法满足企业生产环境所需要的稳定性和安全性需求。</p><p><strong>Kops</strong>：一款用于生产级别的 Kubernetes 集群部署工具，与 AWS、Google、VMware 等国外云厂商耦合度高，需要结合国外云厂商的能力来实现集群的部署，缺乏灵活性。此外由于 Kops 的众多依赖源需要国外网络环境支持，所以其不适合国内企业使用。</p><p><strong>Kubespray</strong>：一款用于生产级别的 Kubernetes 集群部署工具，集成了 Kubeadm 和 Ansible 自动化运维工具，兼容大部分基于 systemd 的操作系统且能够屏蔽底层计算环境的差异，使集群能够部署在物理机、虚拟机、边缘节点、云主机等各种计算环境之上。相较于其它工具，Kubespray 的可扩展性、灵活性更强，很大程度上降低了运维人员的负担，但部署过程中容易出错，对运维人员的使用门槛依旧很高。</p><h3 id="kubean-应运而生" tabindex="-1">Kubean 应运而生 <a class="header-anchor" href="#kubean-应运而生" aria-label="Permalink to &quot;Kubean 应运而生&quot;">​</a></h3><p>在以上述背景下，「Daocloud 道客」基于大量客户真实生产实践上的经验积累和社区技术方案的整合，在今年 6 月份开源了一款生产级的集群生命周期管理（创建、更新、删除）工具——Kubean。Kubean 采用 Kubespray 作为底层技术依赖，一方面简化了集群部署的操作流程，降低了用户的使用门槛。另一方面在 Kubespray 能力基础上增加了集群操作记录、离线版本记录等诸多新特性。Kubean 还提供了界面化创建集群的能力（需要结合社区版 DCE 5.0 容器管理功能），让新手用户也能一键创建和管理集群。本文主要对 Kubean 的主要功能进行介绍，关于社区版 DCE 5.0 的获取，可查阅 <a href="https://www.daocloud.io/dce_5.0_ce%E3%80%82" target="_blank" rel="noreferrer">https://www.daocloud.io/dce_5.0_ce。</a></p><h2 id="_02-kubean-主要功能" tabindex="-1">02 Kubean 主要功能 <a class="header-anchor" href="#_02-kubean-主要功能" aria-label="Permalink to &quot;02 Kubean 主要功能&quot;">​</a></h2><p>集群在线/离线部署Kubean 支持在线、离线两种集群部署方式，满足用户在内网/离线环境下快速部署集群。在离线模式下，最快半小时内就可自动完成一套生产高可用集群的部署。 集群快速扩缩容Kubean 支持对集群进行快速扩缩容操作，能够批量实现节点的增加和删除。并且在集群扩缩容期间，运行在其上面的业务应用不受任何影响。集群版本快速升级Kubean 支持对集群的 Kubernetes版本进行连续升级，在集群版本升级期间，运行在其上面的业务应用依旧不受任何影响。集群故障快速定位Kubean 会对集群部署、版本升级、扩缩容等操作保存详细的日志，当集群发生未知故障导致集群不可用时，通过详细的集群操作日志，用户能快速定位集群故障点。</p><h2 id="_03-kubean-主要特性" tabindex="-1">03 Kubean 主要特性 <a class="header-anchor" href="#_03-kubean-主要特性" aria-label="Permalink to &quot;03 Kubean 主要特性&quot;">​</a></h2><p>简单易用用户可以使用 Helm 包在当前集群对 Kubean 进行快速安装，安装了 Kubean 的集群即能够获得部署、升级、扩缩容新集群的能力。当前 Kubean 支持的 Kubernetes 版本为 v1.20 至 v1.25，容器运行时为 Docker、Containerd、runc 等主流容器运行时。此外 Kubean 还支持对 Cilium、Calico、Multus 、 Cephfs、Local-path-provisioner 等诸多网络和存储插件进行预装，实现集群部署即生产就绪。生产级高可用在部署集群时，支持部署 3 个及以上 master 节点来实现集群的高可用，用户可以根据自身资源和业务重要性来决定高可用方案，进一步保障关键业务能够持续稳定的对外提供服务，降低系统性风险。屏蔽底层基础计算环境差异通过使用 Kubean，用户能够快速基于本地物理机、裸金属、虚拟机、云主机、边缘节点等计算环境部署 Kubernetes 集群，并实现对新建集群的全生命周期进行管理。兼容众多操作系统Kubean 支持麒麟、Centos 等国内外主流操作系统。具体操作系统如下：</p><ul><li>Debian Bullseye, Buster, Jessie, Stretch</li><li>Ubuntu16.04, 18.04, 20.04, 22.04</li><li>CentOS/RHEL 7,8, 9</li><li>Fedora 35, 36</li><li>Fedora CoreOS</li><li>openSUSE Leap 15.x/Tumbleweed</li><li>Oracle Linux 7,8, 9</li><li>Alma Linux 8, 9</li><li>Rocky Linux 8, 9</li><li>Kylin Linux Advanced Server V10</li><li>Amazon Linux 2</li></ul><h2 id="_04-使用在线模式部署集群" tabindex="-1">04 使用在线模式部署集群 <a class="header-anchor" href="#_04-使用在线模式部署集群" aria-label="Permalink to &quot;04 使用在线模式部署集群&quot;">​</a></h2><p>本文将以 Kubean 社区的官方为例，演示如何使用 Kubean 快速在线部署集群，离线部署集群的方式请查阅<a href="https://github.com/kubean-io/kubean/blob/main/doc/offline.zh.md%E3%80%82%E5%9C%A8%E4%BD%BF%E7%94%A8" target="_blank" rel="noreferrer">https://github.com/kubean-io/kubean/blob/main/doc/offline.zh.md。在使用</a> Kubean 部署集群前，您需要预先在您的集群上安装 Kubean。使用 Helm 安装 Kubean首先，将 Kubean 图表存储库添加到您的本地存储库。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://kubean-io.github.io/kubean-helm-chart/</span></span></code></pre></div><p>接下来您可以查看 repo 是否已添加在本次存储库。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            URL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubean-io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       https://kubean-io.github.io/kubean-helm-chart/</span></span></code></pre></div><p>您可以运行以下命令来安装 Kubean。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-io/kubean</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span></code></pre></div><p>查看 Kubean 状态。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LAST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEPLOYED:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Sat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Oct</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:02:46</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2022</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAMESPACE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">STATUS:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">REVISION:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TEST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SUITE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOTES:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Thank</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> installing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Chart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Information:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Chart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Chart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Description:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Information:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">To</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> learn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> more</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> about</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> release,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> try:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  $</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  $</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Documention:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/kubean-io/kubean/blob/main/README.md</span></span></code></pre></div><h3 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h3><p>参照上文使用 Helm 安装 Kubean。 准备两个或两个以上的节点，并且保证节点和当前集群间的网络联通性。 如果在非 root 用户账户下运行，请预先在目标节点中为用户提升权限。</p><h3 id="操作步骤" tabindex="-1">操作步骤 <a class="header-anchor" href="#操作步骤" aria-label="Permalink to &quot;操作步骤&quot;">​</a></h3><ol><li>前往 Github 拉取 Kubean 项目。</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/kubean-io/kubean.git</span></span></code></pre></div><ol start="2"><li>拉取到本地后，执行如下命令进入 kubean/artifacts/demo 文件夹</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean/artifacts/demo</span></span></code></pre></div><ol start="3"><li>执行如下命令修改 hosts-conf-cm.yml 中的 IP 地址为您本地或远程真实存在的节点 IP 地址并保存。</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hosts-conf-cm.yml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#输出如下</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ConfigMap</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cluster1-demo-hosts-conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  hosts.yml:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    all:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      hosts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        node1:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ip:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          access_ip:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_host:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_user:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> who</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  #远端节点登录的用户名，默认为 root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_ssh_pass:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xxx</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #远端节点登录的密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        node2:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ip:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          access_ip:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_host:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #更改为您本地或远端节点的 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_user:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> who</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #远端节点登录的用户名，默认为 root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          ansible_ssh_pass:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xxx</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #远端节点登录的密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      children:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        kube_control_plane:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          hosts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            node1:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        kube_node:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          hosts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            node1:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            node2:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        etcd:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          hosts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            node1:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        k8s_cluster:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          children:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            kube_control_plane:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            kube_node:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        calico_rr:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          hosts:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}</span></span></code></pre></div><ol start="4"><li>在当前安装了 Kubean 的集群上执行如下命令，开始部署新集群</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> demo</span></span></code></pre></div><ol start="5"><li>至此，您便在当前集群开启了一个创建集群的任务，执行如下命令，查看这个任务。</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> job</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubean-system</span></span></code></pre></div><ol start="6"><li>等待任务执行完成，完成集群的创建。</li></ol><h2 id="_05-总结" tabindex="-1">05 总结 <a class="header-anchor" href="#_05-总结" aria-label="Permalink to &quot;05 总结&quot;">​</a></h2><p>本文简单介绍了 Kubean 的部分基础能力，还有更多新玩法等待着大家去发现，可以前往 Kubean 官方社区进一步探索和使用，我们也将之后的系列文章中，进一步带您深入了解 Kubean 这个项目背后的技术原理。</p><p>Kubean 官方社区：<a href="https://github.com/kubean-io/kubean" target="_blank" rel="noreferrer">https://github.com/kubean-io/kubean</a></p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/blog/ocp_image_registry.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>OCP 镜像仓库调研</span><!--]--></a></div><div class="pager" data-v-1bcd8184><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4>Powered by VitePress and <a href="https://samzong.me/" target="_blank">samzong</a></p><!----></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"eucf89hK\",\"api-examples.md\":\"CSzf5RPb\",\"blog_index.md\":\"DKgx38nt\",\"blog_kubean.md\":\"CcJJGHIG\",\"blog_markdown-examples.md\":\"wp6qRuWA\",\"blog_ocp_image_registry.md\":\"Ux0CGSUC\",\"book_index.md\":\"C-niGp5x\",\"index.md\":\"BbnGIOxI\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"YanRongShi\",\"description\":\"yanrongshi's blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"blog\",\"link\":\"/blog\"},{\"text\":\"Examples\",\"link\":\"/blog/markdown-examples\"},{\"text\":\"brok\",\"link\":\"/book\"}],\"sidebar\":{\"/blog/\":[{\"text\":\"2021\",\"collapsed\":false,\"items\":[{\"text\":\"OCP 镜像仓库调研\",\"link\":\"/blog/ocp_image_registry\"},{\"text\":\"kubean 使用\",\"link\":\"/blog/kubean\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/yanrongshi\"}],\"footer\":{\"message\":\"Powered by VitePress and <a href=\\\"https://samzong.me/\\\" target=\\\"_blank\\\">samzong</a>\"},\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"Search\",\"buttonAriaLabel\":\"Search\"},\"modal\":{\"noResultsText\":\"No results found\",\"resetButtonTitle\":\"Reset search\",\"footer\":{\"selectText\":\"to select\",\"navigateText\":\"to navigate\"}}}}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>